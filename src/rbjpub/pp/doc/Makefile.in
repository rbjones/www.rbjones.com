# $Id: Makefile.in,v 1.39 2009/06/27 19:48:40 rbj Exp $

include @top_srcdir@/top_srcdir.mk

RELSRCDIR=src/rbjpub/pp/doc
RELWEBDIR=rbjpub/pp/doc
WEBROOTDIR=../../../
SUBDIRS=

PPDB=pp
PPDBDIR=../
PPXML=
PPDOC=$(PPXML:.xml=.doc)
PPDOCSML=$(PPXML:.xml=.sml)
PPLDS=$(PPXML:.xml=.lds)
PPTH=
#PPTHD=$(PPTH:.th=.thd)
#PPTHDOC=$(PPTH:.th=.th.doc)
PPTHTEX=$(PPTH:.th=.th.tex)

XML007=$(PPXML) tp000.xml
XML008=index.xml
#HTML004=$(XML004:.xml=.html)
#HTML004i=$(XML004:.xml=-i.html)
#HTML004m=$(XML004:.xml=-m.html)
HTMLTHLSi=$(HTMLTHLS:.html=-i.html)
HTMLTHLSm=$(HTMLTHLS:.html=-m.html)

FBOOKTEX=b001.tex b002.tex
FBOOKPDF=$(FBOOKTEX:.tex=.pdf)

TDOC=t000.doc \
        t001.doc t002.doc t003.doc t004.doc t005.doc t006.doc t007.doc \
	t008.doc t009.doc t010.doc t011.doc t012.doc t013.doc t014.doc \
	t015.doc t016.doc t017.doc t018.doc t019.doc t020.doc t021.doc \
	t022.doc t023.doc t024.doc t025.doc t026.doc t027.doc t028.doc \
	t029.doc t030.doc

TTEX=t000.tex \
        t001.tex t002.tex t003.tex t004.tex t005.tex t006.tex t007.tex \
	t008.tex t009.tex t010.tex t011.tex t012.tex t013.tex t014.tex \
	t015.tex t016.tex t017.tex t018.tex t019.tex t020.tex t021.tex \
	t022.tex t023.tex t024.tex t025.tex t026.tex t027.tex t028a.tex \
	t029a.tex t030a.tex

RTTEX=t000.tex \
	t030.tex \
	t029.tex t028.tex t027.tex t026.tex t025.tex t024.tex t023.tex \
	t022.tex t021.tex t020.tex t019.tex t018.tex t017.tex t016.tex \
	t015.tex t014.tex t013.tex t012.tex t011.tex t010.tex t009.tex \
	t008.tex t007.tex t006.tex t005.tex t004.tex t003.tex t002.tex \
	t001.tex

T2DOC=t028.doc t029.doc t030.doc
ATEX=$(T2DOC:.doc=a.tex)
ZTEX=$(T2DOC:.doc=z.tex)

#GRAPHPDF= tp001d1.pdf
#SEMDOC=tp001.doc

SEMTEX=$(SEMDOC:.doc=.tex)
SEMDVI=$(SEMDOC:.doc=.dvi)
SEMPDF=$(SEMDOC:.doc=.pdf)

RBJMK=$(RTTEX)

#TPDOC=tp002.doc tp003.doc
TPDOCA=$(TPDOC:.doc=a.doc)
TPDOCB=$(TPDOC:.doc=b.doc)
TPDOCALL=$(TPDOC) $(TPDOCA) $(TPDOCB)
TPTEX=$(TPDOC:.doc=.tex)
TPTEXA=$(TPDOCA:.doc=.tex)
TPTEXB=$(TPDOCB:.doc=.tex)
TPPDFA=$(TPDOCA:.doc=.pdf)
TPPDFB=$(TPDOCB:.doc=.pdf)
TPPDFALL=$(TPPDFA) $(TPPDFB)
TPPNG=tp003i1.png tp003i2.png
TPTXT=tp002abs.txt tp003abs.txt

TPDF=$(TDOC:.doc=.pdf)

COMDIRCPY= rbj.bib rbj.sty rbjfmu.bst rbjpp.ist texpdf docpdf LICENSE amazon2.sty
SRCDIRCPY=$(XML007) $(SEMDOC) $(TDOC) $(TPDOC) $(TPPNG) $(TPDOCALL) \
	$(TPTXT) $(GRAPHPDF) $(ATEX) $(ZTEX) $(FBOOKTEX) \
	rbj.mkf README.txt indexhead.xml indextail.xml

ENTFILES=pp-symbol.ent

XLDPDIRCPY=$(ENTFILES)

include $(TOPSRCDIR)/build/common/vars.mk

WEBFILES=$(HTML007) $(HTML008) $(HTMLTHLS) $(HTMLTHLSi) $(HTMLTHLSm) $(SEMPDF) \
	$(TPTXT) $(TPDF) $(TPPDFALL) rbj.src.tgz

BUILDEXTRAS=

include $(TOPSRCDIR)/src/common/rules.mk

# directories

# Paths

vpath %.in $(SRCDIR)
#vpath %.xml $(SRCDIR)
vpath %.xsl $(XLCOMDIR)
#vpath %.ent $(XLDPDIR)

# Dependecies

$(FBOOKPDF): %.pdf : rbj.bib rbjfmu.bst

b001.pdf: t028.tex t029.tex t030.tex

b002.pdf: syllog1.th.tex syllog2.th.tex modsyllog.th.tex ariscat.th.tex syll_metap.th.tex 

# Rules

build: pdf doc_theories.tex

rbjmkf: $(SRCDIRCPY) $(COMDIRCPY) t000abs.tex
	touch rbjmkf

pdf: rbjmkf
	make -f rbj.mkf pdf

rbj.src.tgz: rbjmkf
	make -f rbj.mkf src

$(TPDF): %.pdf: %.doc rbj.mkf rbjmkf
	make -f rbj.mkf $@

$(RTTEX): %.tex: %.doc
	make -f rbj.mkf $@

#$(SEMPDF): %.pdf: %.dvi
#	dvips -o '' -t landscape $*
#	ps2pdf $*.ps

doc_theories.tex:
	make -f rbj.mkf doc_theories.tex

t000.pdf: t000abs.tex

t000abs.tex: $(TTEX)
	texindex2tex $(TTEX) > t000abs.tex

indexmiddle.xml: $(RTTEX)
	texindex2xml 16 "" $(RTTEX) > indexmiddle.xml

index.xml: indexhead.xml indexmiddle.xml indextail.xml
	cat $^ > index.xml

tp002a.tex tp002b.tex: tp002.tex

tp002a.pdf: tp002b.pdf

tp003a.tex tp003b.tex: tp003.tex

tp003a.pdf: tp003b.pdf

tp003b.pdf: tp003i1.png tp003i2.png

# RULES

$(SEMTEX): %.tex: %.doc
	doctex $*

$(SEMDVI): %.dvi: %.tex
	texdvi $*

$(SEMPDF): %.pdf: %.tex
	texpdf $* 

$(FBOOKPDF): %.pdf: %.tex
	texpdf $*
	texpdf $*	
	texpdf $*
