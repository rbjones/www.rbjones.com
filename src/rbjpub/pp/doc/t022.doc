=IGN
$Id: t022.doc,v 1.2 2006/12/11 20:54:04 rbj01 Exp $
open_theory "GS";
set_merge_pcs ["hol1", "'savedthm_cs_∂_proof"];
=TEX
\documentclass[11pt,a4paper]{article}
\usepackage{latexsym}
\usepackage{ProofPower}
\ftlinepenalty=9999
\usepackage{A4}

\def\ExpName{\mbox{{\sf exp}}}
\def\Exp#1{\ExpName(#1)}

\tabstop=0.4in
\newcommand{\ignore}[1]{}

\title{Surreal Geometric Analysis}
\makeindex
\usepackage[unicode,pdftex]{hyperref}
\hypersetup{pdfauthor={Roger Bishop Jones}}
\hypersetup{colorlinks=true, urlcolor=black, citecolor=black, filecolor=black, linkcolor=black}

\author{Roger Bishop Jones}
\date{\ }

\begin{document}
\begin{titlepage}
\maketitle
\begin{abstract}
This document is an exploration into formalisation of geometric algebra and analysis using surreal numbers instead of real numbers.
\end{abstract}

\vfill

\begin{centering}

{\footnotesize

Created 2006/12/04

Last Change $ $Date: 2006/12/11 20:54:04 $ $

\href{http://www.rbjones.com/rbjpub/pp/doc/t022.pdf}
{http://www.rbjones.com/rbjpub/pp/doc/t022.pdf}

$ $Id: t022.doc,v 1.2 2006/12/11 20:54:04 rbj01 Exp $ $

\copyright\ Roger Bishop Jones; Licenced under Gnu LGPL

}%footnotesize

\end{centering}

\thispagestyle{empty}
\end{titlepage}
\newpage
\addtocounter{page}{1}
%\section{DOCUMENT CONTROL}
%\subsection{Contents list}
{\parskip=0pt\tableofcontents}
%\newpage
%\subsection{Document cross references}

\subsection*{To Do}
\begin{itemize}
\item 
\item 
\end{itemize}

{\raggedright
\bibliographystyle{fmu}
\bibliography{rbj,fmu}
} %\raggedright

\newpage
\section{INTRODUCTION}

This document is a toe in the water to get a first idea of how hard it is to work with surreal numbers, with the objective ultimately of providing a formal basis for theoretical physics based on geometric algebra.

The stages envisaged are:

\begin{enumerate}
\item The theory of superreals
\item Geometric algebra (GA(0, $\infty$)) based on surreals.
\item Geometric analysis
\item General Relativity and other theoretical physics
\end{enumerate}

We have here also, pro-tem, an axiomatic set theory in which to construct the surreals (but which I intend to put to other uses as well).

\subsection{Preliminary Discussion}

My motivations for undertaking this exploration fall into two categories.

The most important of these, which may however be misconceived, are concerned with possible problems in the formalisation of Physics.

The less important motivation is simply curiosity, which arises I think for me primarily because of the relationship between the surreal numbers and the underlying set theory.

I will discuss these two kinds of motivation separately.

\subsubsection{Motivations Connected with the Formalisation of Physics}

I am interested in the formalisation of Physics:
\begin{itemize}
\item as an exercise in the scientific application of formal methods worthwhile in its own right
\item as a way of approaching related philosophical problems (which I am inclined to class as \emph{metaphysics})
\item as a part of that larger project in the automation of reason which we associate with Leibniz.
\end{itemize}

There are some (rather slender) reasons which have encouraged me to consider whether the analysis on which a formalisation of physics is based might best be a \emph{non-standard} analysis, and some other tenuous reasons for considering that such a non-standard analysis might best be based on the surreal numbers.

My provocations for considering non-standard analysis are as follows:

\begin{itemize}
\item In the course of my investigations to date (see \cite{rbjt002}) I was offered by Rob Arthan some input on differential geometry (see \cite{rbjt003}), in which a centerpiece is the Frechet derivative.
The Frechet generalises the derivative from ordinary analysis to a derivative over functions over vector spaces.
The formulation shown in \cite{rbjt003} delivers for total function between two vector spaces a derivative at some point, if the function is differentiable at that point.
In effect, we begin with a total function, but may well end up with a partial function (the derivative), and this renders awkward the iteration of the function to obtain nth derivatives.
Since the result of the first application need not be a total function, we may not be able to apply the function again.

One way of resolving this problem is shown also in \cite{rbjt003} which is to define the Frechet derivative as delivering a total function of which the value at points where the argument function is not differentiable will be unknown.
This can then be iterated.

Whether this is the right way to deal with iterated differentiation of functions which are not everywhere differentiable unclear.

\item

One of the principle targets for the formalisation of physics envisaged is the theories of special and general relativity, partly because of their relevance to the metaphysics of space and time.
One of the interesting features of the general theory is the occurence of singularities (black holes) under certain circumstances.
Strictly speaking the occurence of a singularity is a breakdown of the theory rather than a bona-fide solution to the differential equations.
In informal mathematical treatments one can safely reason about these partial solutions to the equations, but in a formal treatment it will be necessary to spell out in detail what such a partial solution is so that it can be reasoned about with complete formal rigour.
This might turn out to be awkward and complicated.

The possibility that the use of non-standard analysis might admit full solutions to the equations in these circumstances arises.
If, in the interesting cases where the equations have partial solutions under standard analysis the equations had full solutions under non-standard analysis, then this might provide a better route to formalisation of the theory.

\end{itemize}

Two questions then arise.
First is this the case, and, if the answer to that question is not known, what is the best way to go about getting closer to an answer.

Up until recently I have not had positive views about non-standard analysis and my reasons for this were:
\begin{itemize}
\item I have not been well motivated by the usual grounds offered for adopting non-standard analysis.
It is usually offered as permitting the rigourous use of infinitesimal in accounts of analysis, which corresponds to the best original formulations and is supposed to be more intelligible than the later epsilon-delta formulations which were for about a century thought to be the only way to make these matters fully rigourous.

For my part however, the epsilon-delta formulation has always seemed to me clearer, not least because I could not begin to understand the treatment in terms of infinitesimals until I could understand the number system in which infinitesimals feature.

\item
I have found it much more difficult to get an intuitive grasp of what the numbers used in non-standard analysis are.
The fact that they are arrived at as a non-standard model of the first order axiom system definitely did not recommend it to me.
\end{itemize}

Conway's surreal numbers seemed to me until recently disconnected from these issues.
I thought that to do analysis with them it was necessary to separate out a subset which corresponded to the numbers either of non-standard or of standard analysis (the hyper-reals or the reals), and this promised to be a difficult task.
My interest in the surreal numbers had not been much exercised by the possibility of using them for analysis.

However, in December 2006 I heard a talk by Philip Ehrlich in which he claimed that contrary to what Conway had suggested it was not necessary to separate out a subdomain for non-standard analysis, the surreal numbers as a whole provided a model for non-standard analysis.
This made me immediately consider the possibility of using the surreals as a base for a non-standard analysis to be used in the formalisation of physics.

The surreals can be constructed by two different methods both of which seemed to me to give clear intuitive semantic basis, and if non-standard analysis offered a smoother way to deal with singularities then it was worth serious consideration.




\newpage
\section{GALACTIC SET THEORY}

This is basically a higher order set theory with ``universes'' which I insist on calling ``galaxies''.
I'm going to follow an approach first adopted for the formalisation of the theory of PolySets in Isabell-HOL, in which I make maximal use of the set theoretic vocabulary already available in HOL by defining maps from sets in galactic set theory and the sets (subsets of types) already available in HOL,

First we have a new theory.

=SML
open_theory "rbjmisc";
force_new_theory "GS";
new_parent "fixp";
new_parent "ordered_sets";
set_merge_pcs ["hol1", "'savedthm_cs_∂_proof"];
=TEX

Now the new type and the primitive constant, membership:
=SML
new_type("GS", 0);
new_const("çâg", îGS ≠ GS ≠ BOOLÆ);
declare_infix (70, "çâg");
=TEX

The axioms of extensionality and well-foundedness can be stated immediately:

=SML
val €GS_Ext_ax› = new_axiom(["€Ext›"],
   ¨µx y∑ x=y § µz∑ z çâg x § z çâg yÆ);

val €GS_wf_ax› = new_axiom(["€Wf›"],
   ¨µP∑ (µs∑ (µt∑ t çâg s ¥ P t) ¥ P s) ¥ µx∑ P xÆ);
=TEX

The final axiom states that every set is a member of a galaxy, and also asserts a more global version of replacement.
First the notion of Galaxy is defined.
To do this I first introduce some mappings between GS's and set so GS's.

πHOLCONST
‹ €Xâg› : GS ≠ GS SET
˜¸¸¸¸¸¸¸¸¸
‹ µs∑ Xâg s = {x | x çâg s}
∞

πHOLCONST
‹ €XXâg› : GS ≠ GS SET SET
˜¸¸¸¸¸¸¸¸¸
‹ µs∑ XXâg s = {x | ∂y∑ y çâg s ± x = Xâg y}
∞

πHOLCONST
‹ €∂âg› : GS SET ≠ BOOL
˜¸¸¸¸¸¸¸¸¸
‹ µs∑ ∂âg s § ∂t∑ Xâg t = s
∞

\ignore{
=SML
set_goal([],¨∂Câg∑ µs:GS SET∑ ∂âg s ¥ Xâg (Câg s) = sÆ);
a (rewrite_tac [get_spec ¨∂âgÆ]);
a (prove_∂_tac THEN strip_tac);
a (∂_tac ¨≈t∑ µ x∑ x ç Xâg t § x ç s'Æ
	THEN strip_tac);
a (≈_tac ¨≈t∑ µ x∑ x ç Xâg t § x ç s'Æ);
a (∂_tac ¨tÆ THEN strip_tac);
a (asm_rewrite_tac[]);
save_cs_∂_thm(pop_thm());
=TEX
}%ignore

πHOLCONST
‹ €Câg› : GS SET ≠ GS
˜¸¸¸¸¸¸¸¸¸
‹ µs∑ ∂âg s ¥ Xâg (Câg s) = s
∞

We are now in a position to define galaxies.

πHOLCONST
‹ €Gâg› : GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸
‹ µs∑ Gâg s § µx∑ x çâg s ¥
‹	(∂v∑ v çâg s ± Xâg v = ﬁ(XXâg x))
‹      ± (∂v∑ v çâg s ± XXâg v = {z | z Ä Xâg x})
‹      ± (µr∑ r ç Functional ¥ ∂v∑ v çâg x ± Xâg v = r Image (Xâg x))
∞

Galaxies have the following properties:

\ignore{
=SML
set_goal([], ¨µx∑ Gâg x ¥ ∂âg {}Æ);
a (rewrite_tac (map get_spec [¨GâgÆ, ¨∂âgÆ])
	THEN REPEAT strip_tac);
a (spec_nth_asm_tac 1 ¨≈v:GS∑ v çâg xÆ);
(* *** Goal "1" *** *)
a (∂_tac ¨xÆ THEN rewrite_tac [get_spec ¨XâgÆ] THEN strip_tac);
a (swap_nth_asm_concl_tac 1);
a (≈_tac ¨≈ v∑ v çâg xÆ);
a (∂_tac ¨x'Æ THEN strip_tac);
(* *** Goal "2" *** *)
a (lemma_tac ¨{x: GS∏GS | F} ç FunctionalÆ
	THEN1 rewrite_tac[get_spec ¨FunctionalÆ]);
a (spec_nth_asm_tac 2 ¨{x: GS∏GS | F}Æ);
a (∂_tac ¨v''Æ THEN strip_tac);
a (spec_nth_asm_tac 1 ¨x'Æ);
a (swap_nth_asm_concl_tac 2
	THEN rewrite_tac[get_spec ¨$ImageÆ]);
val G_¥_ö_lemma = save_pop_thm "G_¥_ö_lemma";
=TEX
}%ignore

=GFT
G_¥_ö_lemma =
	Ù µ x∑ Gâg x ¥ ∂âg {}
=TEX


The primarily ontological axiom is then:

=SML
val G_ax = new_axiom(["G"], 
   ¨µx∑ ∂g∑ x çâg g ± Gâg gÆ);
=TEX

The ontological consequences of this need to be teased out.

\ignore{
=SML
set_goal([], ¨∂âg{}Æ);
a (strip_asm_tac (µ_elim ¨≈x:GS∑TÆ G_ax));
a (fc_tac [G_¥_ö_lemma]);
val ∂_ö_lemma = save_pop_thm "∂_ö_lemma";
=TEX
}%ignore

=GFT
∂_ö_lemma =
	Ù ∂âg {}
=TEX

I might possibly also need a global replacement axiom.

\subsection{Relations and Operations over Sets}

=SML
declare_infix (50, "Äâg");
declare_infix (50, "†âg");
=TEX

πHOLCONST
‹ $€Äâg›: GS ≠ GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs t∑ s Äâg t § µx∑ x çâg s ¥ x çâg t
∞

πHOLCONST
‹ $€†âg›: GS ≠ GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs t∑ s †âg t § s Äâg t ± ≥ s = t
∞


πHOLCONST
‹ €ﬁâg›: GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs∑ ﬁâg s = Câg (ﬁ (XXâg s))
∞

We will need an ordered pair, for which the Wiener-Kuratowski version will do:

πHOLCONST
‹ €Wkpâg›: GS ≠ GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µl r∑ Wkpâg l r = Câg {Câg{l}; Câg{l;r}}
∞

=SML
declare_alias ("Ìâg", ¨WkpâgÆ);
declare_infix (1100, "Ìâg");
=TEX

\subsection{Ordinals}

Zero:

πHOLCONST
‹ €öâg›: GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ öâg = Câg {}
∞

\ignore{
=SML
set_goal([], ¨µx∑ ≥ x çâg öâgÆ);
a (rewrite_tac (map get_spec [¨öâgÆ]));
a (asm_tac (∂_ö_lemma));
a (FC_T (MAP_EVERY ante_tac) [get_spec ¨CâgÆ]);
a (rewrite_tac (map get_spec [¨XâgÆ]));
val ≥çö_thm = save_pop_thm "≥çö_thm" ;

set_goal([], ¨Câg {} = öâg ± Câg {x|F} = öâgÆ);
a (rewrite_tac [get_spec ¨öâgÆ]);
a (LEMMA_T ¨{x:GS|F} = {}Æ rewrite_thm_tac THEN1 prove_tac[]);
val C_ö_lemma = save_pop_thm "C_ö_lemma";

set_goal([], ¨µs∑ öâg Äâg sÆ);
a (rewrite_tac [get_spec ¨$ÄâgÆ,  ≥çö_thm]);
val Äâgö_lemma = save_pop_thm "Äâgö_lemma";
=TEX
}%ignore

=GFT
≥çö_thm =
	Ù µ x∑ ≥ x çâg öâg
C_ö_lemma =
	Ù Câg {} = öâg ± Câg {x|F} = öâg
Äâgö_lemma =
	Ù µ s∑ öâg Äâg s
=TEX

and the successor function:

πHOLCONST
‹ €succâg›: GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µon∑ succâg on = Câg {x | x = on ≤ x çâg on}
∞

A property of sets is ordinal closed if it is true of the empty set and is closed under successor and limit constructions.

πHOLCONST
‹ €Oclosed›: (GS ≠ BOOL) ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µps∑ Oclosed ps § ps öâg
‹	± (µx∑ ps x ¥ ps (succâg x))
‹	± (µss∑ (µx∑ x çâg ss ¥ ps x) ¥ ps (ﬁâg ss)) 
∞

πHOLCONST
‹ €Ordinal›: GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs∑ Ordinal s § µps∑ Oclosed ps ¥ ps s
∞

\ignore{
=SML
set_goal([], ¨Ordinal öâgÆ);
a (rewrite_tac [get_spec ¨OrdinalÆ, get_spec ¨OclosedÆ]
	THEN REPEAT strip_tac);
val ord_ö_lemma = save_pop_thm "ord_ö_lemma";

set_goal([], ¨µs∑ Ordinal s ¥ Ordinal (succâg s)Æ);
a (rewrite_tac [get_spec ¨succâgÆ]);
=TEX
}%ignore

=GFT
ord_ö_lemma =
	Ù Ordinal öâg
=TEX

πHOLCONST
‹ €1âg› €2âg›: GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ 1âg = succâg öâg ± 2âg = succâg 1âg 
∞


πHOLCONST
‹ €Transitiveâg›: GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs∑ Transitiveâg s § µt∑ t çâg s ¥ t Äâg s
∞


\ignore{
=IGN
set_goal([], ¨µs∑ Ordinal s ¥ Transitiveâg sÆ);
a (rewrite_tac [get_spec ¨TransitiveâgÆ]);

set_goal([], ¨WellFounded (ordinals, $†âg)Æ);
a (rewrite_tac [well_founded_induction_thm, get_spec ¨$†âgÆ, get_spec ¨$ÄâgÆ]
	THEN REPEAT strip_tac);
a (asm_tac (((rewrite_rule []) o (µ_elim ¨Ãx∑ x ç ordinals ¥ p xÆ)) GS_wf_ax));
a (lemma_tac ¨µ s∑ (µ t∑ t çâg s ¥ t ç ordinals ¥ p t) ¥ s ç ordinals ¥ p sÆ
	THEN1 REPEAT strip_tac);
(* *** Goal "1" *** *)
a (spec_nth_asm_tac 5 ¨sÆ);


=TEX
}%ignore

\subsection{Relations and Functions}

πHOLCONST
‹ €Relation›: GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs∑ Relation s § µx∑ x çâg s ¥ ∂l r:GS∑ x = l Ìâg r 
∞

\ignore{
=SML
set_goal([], ¨Relation öâgÆ);
a (rewrite_tac [get_spec ¨RelationÆ, ≥çö_thm]);
val rel_ö_lemma = save_pop_thm "rel_ö_lemma";
=TEX
}%ignore

=GFT
rel_ö_lemma = 
	Ù Relation öâg
=TEX

πHOLCONST
‹ €Function›: GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs∑ Function s § Relation s ± µx y z:GS∑ x Ìâg y çâg s ± x Ìâg z çâg s ¥ y = z   
∞

\ignore{
=SML
set_goal([], ¨Function öâgÆ);
a (rewrite_tac [get_spec ¨FunctionÆ, rel_ö_lemma, ≥çö_thm]);
val func_ö_lemma = save_pop_thm "func_ö_lemma";
=TEX
}%ignore

=GFT
func_ö_lemma =
	Ù Function öâg
=TEX

πHOLCONST
‹ €domain›: GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs∑ domain s = Câg {x | ∂y∑ x Ìâg y çâg s}   
∞

\ignore{
=SML
set_goal([], ¨domain öâg = öâgÆ);
a (rewrite_tac [get_spec ¨domainÆ, rel_ö_lemma, ≥çö_thm, C_ö_lemma]);
val dom_ö_lemma = save_pop_thm "dom_ö_lemma";
=TEX
}%ignore

=GFT
dom_ö_lemma =
	Ù domain öâg = öâg
=TEX

πHOLCONST
‹ €range›: GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs∑ range s = Câg {y | ∂x∑ x Ìâg y çâg s}   
∞

\ignore{
=SML
set_goal([], ¨range öâg = öâgÆ);
a (rewrite_tac [get_spec ¨rangeÆ, rel_ö_lemma, ≥çö_thm, C_ö_lemma]);
val ran_ö_lemma = save_pop_thm "ran_ö_lemma";
=TEX
}%ignore

=GFT
ran_ö_lemma =
	Ù range öâg = öâg
=TEX

=SML
declare_infix (900, "∏âg");
=TEX

Cartesian product:

πHOLCONST
‹ $€∏âg›: GS ≠ GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs t∑ s ∏âg t = Câg {p:GS | ∂l r∑ l çâg s ± r çâg t ± p = l Ìâg r}   
∞

=GFT
=TEX

\subsection{Proof Context}

\ignore{
=SML
set_goal([], ¨Câg {} = öâg
	± Câg {x|F} = öâg
	± (µ s∑ öâg Äâg s)
	± Ordinal öâg
	± Relation öâg
	± Function öâg
	± domain öâg = öâg
	± range öâg = öâg
Æ);

a (rewrite_tac [C_ö_lemma, Äâgö_lemma, ord_ö_lemma, rel_ö_lemma, func_ö_lemma,
	dom_ö_lemma, ran_ö_lemma]);
val GS_ö_clauses = save_pop_thm "GS_ö_clauses";
=TEX
}%ignore

=GFT
GS_ö_clauses =
   Ù Câg {} = öâg
       ± Câg {x|F} = öâg
       ± (µ s∑ öâg Äâg s)
       ± Ordinal öâg
       ± Relation öâg
       ± Function öâg
       ± domain öâg = öâg
       ± range öâg = öâg
=TEX

\ignore{
=SML
force_new_pc "'GS1";
add_rw_thms [GS_ö_clauses] "'GS1";
add_sc_thms [GS_ö_clauses] "'GS1";
add_st_thms [GS_ö_clauses] "'GS1";
=IGN
force_new_pc "'nfu_f2";
set_rw_eqn_cxt ([(¨x = yÆ, nfu_f_eq_ext_conv)]) "'nfu_f2";
add_rw_thms [get_spec ¨$ÄânfÆ, nfu_f_op_ext_clauses2] "'nfu_f2";

set_pr_conv nfu_f_prove_conv "'nfu_f2";
set_pr_tac nfu_f_prove_tac "'nfu_f2";
=SML
set_merge_pcs ["hol1", "'savedthm_cs_∂_proof", "'GS1"];
=TEX
}%ignore

\newpage
\section{SURREAL NUMBERS}

The plan of action here is as follows.
First I speculate on an axiomatisation of the surreal numbers sufficient for non-standard analysis (the surreals of rank up to 2*w would probably suffice).
Then this axiomatisation is evaluated in two different ways.
It is used for the development of parts of the theory of surreals, heading as rapidly as is possible in the direction of analysis.
It is also validated by performing a construction which delivers the axioms.

Three theories are therefore produced.
The first, \emph{sra}, contains the axiomatisation and its development.
The second, \emph{src}, contains the construction preliminary to {\it defining} (in the third theory, \emph{srd}) a type of surreals satisfying the axioms in the first theory.

If this were to go well, then the surreals would be used as a base for something like geometric algebra and analysis would then be developed in that context.
If I can find a way of exploring these latter two options without completing the previous developments then I may do that.
Unfortunately my main motivation for considering the surreal numbers is in the possibility that non-standard analysis would provide a better base than standard analysis for reasoning formally about general relativity, and in particular reasoning about ``solutions'' to the gravitational ``field equations'' in those circumstances in which singularities arise (i.e. black holes).
I really have no idea whether it will help.
Even in non-standard analysis division by zero fails, so possibly the singularities remain.

From that point of view I should be looking at non-standard analysis not at the construction of surreal numbers.


\subsection{An Axiomatisation of the Surreal Numbers}

Since this document is exploratory in nature, and proofs take time, it is worthwhile to explore the axiomatisation of surreal numbers independently of the construction.
This may help in deciding how the development of the theory on the basis of the construction should be done, or it may just be a faster way of deciding whether the entire enterprise is worth the candle.

I understand from Philip Ehrich that he has published an axiomatisation of the surreals independent of set theory in the Journal of Symbolic logic, but I don't have ready access to it so I am importing into this document an axiomatisation which I did a few years back.

For this purpose a new theory ``sra'' is introduced in a context which does not include an axiomatic set theory.
=SML
open_theory "rbjmisc";
force_new_theory "sra";
new_parent "ordered_sets";
set_merge_pcs ["hol1", "'savedthm_cs_∂_proof"];
=TEX

\subsubsection{Primitive Types and Constants}
=SML
new_type ("No", 0);
new_const ("öâs", îNoÆ);
declare_alias ("ö", ¨öâsÆ);
new_const ("<âs", îNo ≠ No ≠ BOOLÆ);
declare_alias ("<", ¨<âsÆ);
new_const ("IC", î(No ≠ BOOL) ≠ No ≠ NoÆ);
declare_infix (240, "<<");
=TEX

\subsubsection{Definitions}

πHOLCONST
‹	rank: No ≠ No
˜
‹	µn∑ rank n = IC (Ãx∑T) n
∞
πHOLCONST
‹	$<<: No ≠ No ≠ BOOL
˜
‹	µn m∑ n << m = rank n < rank m
∞
=TEX

\subsubsection{The Zero Axiom}
=SML
new_axiom (["SZeroAx"], ¨µx∑ rank x = ö § x = öÆ );
=TEX

\subsubsection{The Cut Axiom}

The following axiom states that, for:

\begin{enumerate}
\item any property p of surreals and
\item surreal n such that p is downward closed on the surreals of lower rank than n
\end{enumerate}

there exists a surreal number (IC p n) such that:

\begin{itemize}
\item (IC p n) is in between the surreals of rank less than n with the property and those of rank less than n without the property, and
\item where p and q define the same cut on the surreals of rank less than n then (IC p n) is the same surreal as (IC q n).
\end{itemize}

=SML
new_axiom (["SCutAx"],
¨µp: No ≠ BOOL; n: No∑
	(µx y: No∑ x << n ± y << n ± x < y ± p y ¥ p x)
	¥ (µx: No∑ x << n ¥ (p x § x < (IC p n)) ± (≥ p x § (IC p n) < x))
	± (µq: No ≠ BOOL∑ (µx∑ x << n ¥ (p x § q x)) § (IC p n) = (IC q n))
Æ);
=TEX

\subsubsection{The Induction Axiom}

The following axiom states that for any property p of surreals, if p holds for a surreal n whenever it holds for all the surreals of lower rank than n, then it holds for all surreals.

This is the same as Conway's induction axiom since the union of the two sides of the canonical cuts ("games") on which this axiomatization is based is the set of all numbers of lower rank.

=SML
new_axiom (["SIndAx"], ¨WellFounded (Universe, $<<)Æ);
=TEX

\subsubsection{Infinity}

This is the ordinal version of my strong infinity for HOL axiom, asserted of the surreals rather than the individuals.
I have a fairly low level of confidence in this as yet, and am no longer inclined to this style of axiom.
I don't know whether it's best to assert it of $<<$, or of $<<$ restricted to ordinals.
For the present I will just display rather than actually adopt the axiom and assert a much weaker axiom which will probably suffice for the applications I have in mind (i.e. for analysis).
=GFT
declare_infix (240, "e");
new_axiom (["SInfAx"], ¨
   µp∑ ∂q∑ p << q 
	± (µx∑ x << q ¥
		((∂y $e∑ y << q
		  ± (µZ∑ ∂u∑ u << y
			± (µv∑ v << x ¥ (v e u § Z v))
		     )
		  )
		± (µG∑ (µu∑ u << x ¥ (G u) << q)
		    ¥ ∂y∑ y << q ± µu∑ u << x ¥ (G u) << y
	           )
            )
)
Æ);
=TEX

The weak axiom of infinity has some similarity with the galactic closure axiom for GS.
Taking the idea of a galaxy but limiting the closure properties to closure under replacement, we get the following axiom.
Think of it in terms of ordinals which we may think of according the the Von Neumann conception (though the model behind the surreals is not the same) in which each ordinal is the set of its predecessors (in the surreals it is more like an ordinal is the set of numbers of smaller rank).
So we are asserting that for every surreal ordinal $s$ there is a large ordinal $g$ which is ``closed under replacement'', i.e. the image of an ordinal $x$ under a function $f$ is bounded in the galaxy if it is a subset of it.


=SML
new_axiom (["WInfAx"], ¨
     µs∑ ∂g∑ s << g
     ± µx f∑
	  x << g
	± (µy∑ y << x ¥ f y << g)
	¥ ∂z∑ z << g ± µv∑ v << x ¥ f v << zÆ);

=TEX

\subsection{Constructing the Surreal Numbers}

=SML
open_theory "GS";
force_new_theory "src";
set_merge_pcs ["hol1", "'savedthm_cs_∂_proof", "'GS1"];
=TEX

\subsubsection{The Representation of Surreals}

Its not clear what is the best way to do this, so I may end up trying more than one method.
The first method is to use transfinite binary expansions which I have done following the Wikpedia account (though not slavishly).

A surreal number is a function whose domain is an ordinal and whose range is a subset of $2âg$:

πHOLCONST
‹ €Surreal_rep›: GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs∑ Surreal_rep s § Function s ± Ordinal (domain s) ± (range s) Äâg 2âg   
∞

\ignore{
=SML
set_goal([], ¨∂x∑ Surreal_rep xÆ);
a (rewrite_tac (map get_spec [¨Surreal_repÆ]));
a (∂_tac ¨öâgÆ);
a (rewrite_tac []);
val Surreal_exists_thm = save_pop_thm "Surreal_exists_thm";
=TEX
}%ignore

=GFT
Surreal_exists_thm =
	Ù ∂ x∑ Surreal_rep x
=TEX

Sometimes its handy to have this as a set:

πHOLCONST
‹ €surreal_reps›: GS SET
˜¸¸¸¸¸¸¸¸¸¸¸
‹ surreal_reps = {s | Surreal_rep s}
∞

\subsubsection{Defining The Constants used in The Axioms}

We will need to define operations over the surreals using transfinite recursion, and for that purpose a suitable well-founded relation is needed.
The surreal representatives are partially ordered by their length, which is of course, their domain.

=SML
declare_infix (70, "<<âsrr");
=TEX

πHOLCONST
‹ $€<<âsrr›: GS ≠ GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µx y∑ x <<âsrr y § Surreal_rep x ± Surreal_rep y ± domain x †âg domain y
∞

\ignore{
=IGN
stop;
set_goal([], ¨WellFounded (surreal_reps, $<<âsrr)Æ);
a (rewrite_tac [get_spec ¨surreal_repsÆ, well_founded_induction_thm, get_spec ¨$<<âsrrÆ]);
a (REPEAT strip_tac);
a (asm_tac (µ_elim ¨pÆ GS_wf_ax));
a (lemma_tac ¨(µ s∑ (µ t∑ t çâg s ¥ p t) ¥ p s)Æ
	THEN REPEAT strip_tac);

=TEX
}%ignore

=GFT
=TEX

=SML
declare_infix (70, "<âsrr");
=TEX

The next key element of the construction is the usual linear ordering of the surreals.
πHOLCONST
‹ $€<âsrr›: GS ≠ GS ≠ BOOL
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µs t∑ s <âsrr t §
‹	s Äâg t ± (domain s Ìâg 1âg) çâg t
‹   ≤	t Äâg s ± (domain t Ìâg öâg) çâg s
‹   ≤	(∂z∑ z Äâg s ± z Äâg t
‹	± (domain z Ìâg öâg) çâg s ± (domain z Ìâg 1âg) çâg t)
∞

In order to do this we need to define some auxiliary functions which translate between binary expansions and cuts in the numbers.

First, from a number obtain a left and a right set of numbers:

πHOLCONST
‹ €L›: GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µn∑ L n =  Câg{m | m †âg n ± domain m Ìâg 1âg çâg n}   
∞
πHOLCONST
‹ €R›: GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µn∑ R n =  Câg {m | m †âg n ± domain m Ìâg öâg çâg n}   
∞

Each pair of sets of numbers $L$, $R$ such that every element of $L$ is less than every element of $R$, determines a unique number $”(L, R)$ which is the simplest number between the two sets.

This does not correspond precisely to the WIkpedia account, since in it $”(L,R)$ is supposed to be strictly between $L$ and $R$, and right now I can't see how to do that in the case that one half contains a number which is an initial segment of a number in the other half.

πHOLCONST
‹ €”›: GS ∏ GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µls rs∑ ”(ls, rs) =  Câg (ﬁ {i | ∂le re∑ le çâg ls ± re çâg rs ± i = (Xâg le) ° (Xâg re)})
∞


\subsubsection{Defining the Arithmetic Operators}

These are the definitions of the arithmetic operations which go with the above definition of the construction of the surreals.
They probably can and should be done in the new type of surreals after it has been introduced, but I had already done them before that occurred to me, and will remain at least until I have satisfied myself that definition the later is preferable.

=SML
declare_right_infix (210, "+âsrr");
declare_right_infix (210, "-âsrr");
declare_right_infix (220, "*âsrr");
=TEX

The following definition is by transfinite recursion on the rank of the surreal numbers involved.
A proof script is required (not yet supplied) to show that the function is well-defined.

\ignore{
=IGN
stop;
set_goal([], ¨∂$+âsrr∑ µx y∑ Surreal_rep x ± Surreal_rep y ¥
     x +âsrr y = ”(
	Câg({a | ∂u∑ a = u +âsrr y ± u çâg L(x)} ¿ {a | ∂v∑ a = x +âsrr v ± v çâg L(y)}),
	Câg({a | ∂u∑ a = u +âsrr y ± u çâg R(x)} ¿ {a | ∂v∑ a = x +âsrr v ± v çâg R(y)}))
Æ);
a (PC_T1 "hol" lemma_tac ¨∂f∑ f = Ãp∑ (Surreal_rep x ± Surreal_rep y ¥
     p x y = ”(
	Câg({a | ∂u∑ a = p u y ± u çâg L(x)} ¿ {a | ∂v∑ a = p x v ± v çâg L(y)}),
	Câg({a | ∂u∑ a = p u y ± u çâg R(x)} ¿ {a | ∂v∑ a = p x v ± v çâg R(y)})))Æ
	THEN prove_∂_tac);

recursion_theorem

=TEX
}%ignore

πHOLCONST
‹ $€+âsrr›: GS ≠ GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µx y∑ Surreal_rep x ± Surreal_rep y ¥
‹     x +âsrr y = ”(
‹	Câg({a | ∂u∑ a = u +âsrr y ± u çâg L(x)} ¿ {a | ∂v∑ a = x +âsrr v ± v çâg L(y)}),
‹	Câg({a | ∂u∑ a = u +âsrr y ± u çâg R(x)} ¿ {a | ∂v∑ a = x +âsrr v ± v çâg R(y)}))
∞

πHOLCONST
‹ $€~âsrr›: GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µx∑ Surreal_rep x ¥
‹     ~âsrr x = Câg{z | ∂u v∑ z = u Ìâg v ± u Ìâg (if v = öâg then 1âg else öâg) çâg x}
∞

πHOLCONST
‹ $€-âsrr›: GS ≠ GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µx y∑ Surreal_rep x ± Surreal_rep y ¥
‹     x -âsrr y = x +âsrr (~âsrr y)
∞

πHOLCONST
‹ $€*âsrr›: GS ≠ GS ≠ GS
˜¸¸¸¸¸¸¸¸¸¸¸
‹ µx y∑ Surreal_rep x ± Surreal_rep y ¥
‹     x *âsrr y = ”(
‹	Câg{a | ∂u v∑ a = u *âsrr y +âsrr x *âsrr v -âsrr u *âsrr v
‹		± (u çâg L(x) ± v çâg L(y) ≤ u çâg R(x) ± v çâg R(y))},
‹	Câg{a | ∂u v∑ a = u *âsrr y +âsrr x *âsrr v -âsrr u *âsrr v
‹		± (u çâg L(x) ± v çâg R(y) ≤ u çâg R(x) ± v çâg L(y))})
∞

\ignore{
=IGN

=TEX
}%ignore


\subsection{The Theory of Surreal Numbers}

=SML
open_theory "src";
force_new_theory "sr";
set_merge_pcs ["hol1", "'savedthm_cs_∂_proof", "'GS1"];
new_type_defn (["sr"], "sr", [], Surreal_exists_thm);
=TEX

\ignore{
=SML

=TEX
}%ignore

{\let\Section\section
\newcounter{ThyNum}
\def\section#1{\Section{#1}
\addtocounter{ThyNum}{1}\label{Theory\arabic{ThyNum}}}
\include{GS.th}
\def\section#1{\Section{#1}
\addtocounter{ThyNum}{1}\label{Theory\arabic{ThyNum}}}
\include{sra.th}
\def\section#1{\Section{#1}
\addtocounter{ThyNum}{1}\label{Theory\arabic{ThyNum}}}
\include{src.th}
\def\section#1{\Section{#1}
\addtocounter{ThyNum}{1}\label{Theory\arabic{ThyNum}}}
\include{sr.th}
}  %\let

\twocolumn[\section{INDEX}\label{index}]
{\small\printindex}

\end{document}
